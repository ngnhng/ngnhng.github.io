---
import Tag from "@/components/Tag.astro";
import TOC from "../components/TOC.astro";

const { frontmatter, headings } = Astro.props;
const { title, pubDate, tags } = frontmatter;

const imageSrc = frontmatter.image;
---

<div class="relative flex flex-col items-center">
  <div
    class="absolute inset-0 z-0 h-64 w-screen left-1/2 transform -translate-x-1/2 bg-cover bg-center opacity-30"
    style={`background-image: url(${imageSrc})`}
  >
  </div>
  <div
    class="relative z-10 mb-8 md:m-8 gap-y-4 sm:gap-y-6 sm:mb-10 flex flex-col items-center pt-20 md:pt-16 p-2"
  >
    <h1
      class="text-4xl font-bold text-font-color dark:text-font-invert text-center"
    >
      {title}
    </h1>
    {
      pubDate && (
        <p class="text-sm text-gray-500 dark:text-gray-400 w-full">
          {pubDate
            ? new Date(pubDate).toLocaleDateString("en-US", {
                year: "numeric",
                month: "long",
              })
            : ""}
        </p>
      )
    }
    {
      tags && tags.length > 0 && (
        <div class="flex flex-wrap gap-2 mt-2 w-full">
          {tags.map((tag: any) => (
            <Tag value={tag} key={tag} href={`/tags/${tag}`} />
          ))}
        </div>
      )
    }
  </div>
  <div class="flex w-full max-w-7xl px-4 md:mt-20">
    <aside class="hidden md:block md:w-1/4 lg:w-1/5 sticky top-20 h-screen">
      <div class="sticky top-20 mr-10">
        <TOC headings={headings} />
      </div>
    </aside>
    <div class="w-full md:mt-10 md:w-3/4 lg:w-4/5">
      <article
        class:list={[
          "prose prose-slate mb-8 break-words text-font-color dark:prose-invert sm:mb-10",
          "prose-h2:text-3xl prose-h3:text-2xl prose-h4:text-xl prose-h5:text-lg prose-h6:text-lg prose-p:text-lg",
          "font-serif prose-headings:font-sans",
        ]}
      >
        <slot />
      </article>
    </div>
  </div>
</div>

<style>
  .bg-cover {
    background-size: cover;
  }
  .bg-center {
    background-position: center;
  }
</style>
